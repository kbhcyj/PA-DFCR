# PA-DFCR Experiment Suite

**PA-DFCR (Progressive-Adaptive Data-Free Compression Restoration)** ì•Œê³ ë¦¬ì¦˜ì˜ ê³µì‹ êµ¬í˜„ì²´ ë° ì‹¤í—˜ ìŠ¤ìœ„íŠ¸ì…ë‹ˆë‹¤.
ë³¸ í”„ë¡œì íŠ¸ëŠ” ê¸°ì¡´ **LBYL (Look-Before-You-Leap)** ê°€ì§€ì¹˜ê¸°(Pruning) ê¸°ë²•ì„ **Iterative (ë°˜ë³µì )** ë°©ì‹ìœ¼ë¡œ í™•ì¥í•˜ì—¬, Fine-tuning ì—†ì´ë„ ëª¨ë¸ì˜ ì„±ëŠ¥ ì†ì‹¤ì„ ìµœì†Œí™”í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

## ğŸ“Œ ì£¼ìš” íŠ¹ì§•
- **Iterative Pruning**: í•œ ë²ˆì— ì••ì¶•í•˜ëŠ” ëŒ€ì‹ , ì—¬ëŸ¬ ë‹¨ê³„ì— ê±¸ì³ ì ì§„ì ìœ¼ë¡œ ì••ì¶•í•˜ì—¬ ì •ë³´ ì†ì‹¤ì„ ì¤„ì…ë‹ˆë‹¤.
- **Data-Free**: ì›ë³¸ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ì¬í•™ìŠµ(Fine-tuning)í•˜ê±°ë‚˜ Batch Normalizationì„ ì¬ë³´ì •(Re-calibration)í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- **Reproducibility**: ëª¨ë“  ì‹¤í—˜ì€ ì‹œë“œ(Seed)ë¥¼ ê³ ì •í•˜ì—¬ ê²°ì •ë¡ ì (Deterministic)ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

---

## ğŸš€ ì‹œì‘í•˜ê¸° (Getting Started)

### 1. í™˜ê²½ ì„¤ì • (Prerequisites)

Python 3.8 ì´ìƒì´ í•„ìš”í•©ë‹ˆë‹¤. Anacondaë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.

```bash
# 1. ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
conda create -n pa-dfcr python=3.8
conda activate pa-dfcr

# 2. ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -r requirements.txt
```

### 2. ë°ì´í„°ì…‹ ë° ëª¨ë¸ ì¤€ë¹„ (Setup)

ë³¸ í”„ë¡œì íŠ¸ëŠ” CIFAR-10, CIFAR-100 ë“±ì˜ ë°ì´í„°ì…‹ê³¼ ì‚¬ì „ í•™ìŠµëœ(Pre-trained) ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
ì œê³µëœ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ í•„ìš”í•œ í´ë” êµ¬ì¡°ë¥¼ ì¡ê³  ì•ˆë‚´ë¥¼ ë°›ìœ¼ì„¸ìš”.

```bash
# ë°ì´í„°ì…‹ ë° ëª¨ë¸ í´ë” ìƒì„± ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
bash download_assets.sh
```

ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ í›„, **`saved_models/`** í´ë”ì— ë‹¤ìŒ ì‚¬ì „ í•™ìŠµëœ ëª¨ë¸ íŒŒì¼(`.pth.tar`)ì„ ë„£ì–´ì£¼ì„¸ìš”.
(ì €ì‘ê¶Œ ë° ìš©ëŸ‰ ë¬¸ì œë¡œ ê¹ƒí—ˆë¸Œì—ëŠ” í¬í•¨ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.)

**í•„ìˆ˜ ëª¨ë¸ íŒŒì¼ ëª©ë¡:**
- `saved_models/VGG.cifar10.original.pth.tar`
- `saved_models/ResNet.cifar100.original.50.pth.tar`
- `saved_models/LeNet_300_100.original.pth.tar`

**í´ë” êµ¬ì¡° ì˜ˆì‹œ:**
```text
PA_DFCR_LBYL_Experiment/
â”œâ”€â”€ data/                  # ë°ì´í„°ì…‹ (CIFAR-10 ë“± ìë™ ë‹¤ìš´ë¡œë“œë¨)
â”œâ”€â”€ saved_models/          # [ì¤‘ìš”] ì—¬ê¸°ì— .pth.tar íŒŒì¼ì„ ë„£ìœ¼ì„¸ìš”
â”œâ”€â”€ src/                   # ì†ŒìŠ¤ ì½”ë“œ
â”œâ”€â”€ main.py                # ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ ...
```

---

## ğŸ§ª ì‹¤í—˜ ì‹¤í–‰ (Usage)

### 1. ë‹¨ì¼ ì‹¤í—˜ ì‹¤í–‰ (Quick Start)
ê°„ë‹¨í•˜ê²Œ VGG16 ëª¨ë¸ì„ 50% ì••ì¶•í•˜ëŠ” ì‹¤í—˜ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

```bash
bash run_experiment.sh
```
* `run_experiment.sh` íŒŒì¼ì„ ì—´ì–´ `ARCH`, `COMPRESSION` ë“±ì˜ ë³€ìˆ˜ë¥¼ ìˆ˜ì •í•˜ë©´ ë‹¤ë¥¸ ì‹¤í—˜ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### 2. ëŒ€ê·œëª¨ ì‹¤í—˜ ìŠ¤ìœ„íŠ¸ (Suite)
ì—¬ëŸ¬ ëª¨ë¸ê³¼ ì••ì¶•ë¥  ì¡°í•©ì„ í•œ ë²ˆì— ì‹¤í–‰í•˜ë ¤ë©´ ìŠ¤ìœ„íŠ¸ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.

```bash
# 1. ì‹¤í–‰ ê³„íš í™•ì¸ (Dry Run)
bash run_suite.sh --dry-run

# 2. ì „ì²´ ì‹¤í—˜ ì‹œì‘ (GPU ê¶Œì¥)
bash run_suite.sh

# 3. ì¤‘ë‹¨ëœ ì‹¤í—˜ ì´ì–´í•˜ê¸° (Resume)
bash run_suite.sh --resume
```
* `suite.py` íŒŒì¼ ìƒë‹¨ì˜ `EXPERIMENTS` ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆ˜ì •í•˜ì—¬ ì‹¤í—˜ ê³„íšì„ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 3. ìƒì„¸ ì˜µì…˜ (Custom CLI)
`main.py`ë¥¼ ì§ì ‘ ì‹¤í–‰í•˜ì—¬ ì„¸ë¶€ ì„¤ì •ì„ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
# ì˜ˆ: ResNet50, 70% ì••ì¶•, 10íšŒ ë°˜ë³µ
python main.py \
    --arch ResNet50 \
    --dataset cifar100 \
    --pretrained saved_models/ResNet.cifar100.original.50.pth.tar \
    --compression 0.7 \
    --iterations 10 \
    --lamda-1 0.000006 --lamda-2 0.0001 \
    --results-dir my_custom_results
```

---

## ğŸ“Š ê²°ê³¼ í™•ì¸ (Results)

ì‹¤í—˜ì´ ì™„ë£Œë˜ë©´ `csv` í˜•ì‹ì˜ ê²°ê³¼ íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤.

*   **íŒŒì¼ëª… í˜•ì‹**: `iterative_results_{ëª¨ë¸}_{ë°ì´í„°ì…‹}_comp{ì••ì¶•ë¥ }_iter{ë°˜ë³µìˆ˜}_{íƒ€ì„ìŠ¤íƒ¬í”„}.csv`
*   **ë‚´ìš©**: ê° ë°˜ë³µ(Iteration) ë³„ ì••ì¶•ë¥ , ì •í™•ë„(Accuracy), íŒŒë¼ë¯¸í„° ìˆ˜ ë“±ì´ ê¸°ë¡ë©ë‹ˆë‹¤.

**ì˜ˆì‹œ:**
```csv
iteration,compression_rate,cumulative_compression,accuracy,num_parameters,...
0,0.0,0.0,93.7,14987722,...
1,0.29,0.29,83.4,7549756,...
2,0.29,0.50,53.6,3820010,...
```

ìŠ¤ìœ„íŠ¸ ì‹¤í–‰ ì‹œ, ëª¨ë“  ê²°ê³¼ê°€ í†µí•©ëœ `summary_all.csv` íŒŒì¼ë„ ìƒì„±ë©ë‹ˆë‹¤.

---

## ğŸ“ ì°¸ê³  ì‚¬í•­
*   ì´ í”„ë¡œì íŠ¸ëŠ” `LBYL2022` ì—°êµ¬ ì½”ë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¦¬íŒ©í† ë§ë˜ì—ˆìŠµë‹ˆë‹¤.
*   **One-shot LBYL**ì„ ì¬í˜„í•˜ë ¤ë©´ `--iterations 1`ë¡œ ì„¤ì •í•˜ì„¸ìš”.
*   **PA-DFCR (Iterative)**ëŠ” `--iterations`ë¥¼ 2 ì´ìƒìœ¼ë¡œ ì„¤ì •í•˜ë©´ ë©ë‹ˆë‹¤.
